{% extends "main.html" %}

{% block css %}
    {{ block.super }}
    <link href="{{ STATIC_URL }}css/list.css" rel="stylesheet">
{% endblock %}

{% block sub_content%}
    {% if tracks_list %}
    <h1>Список трэков</h1>
    <table class="table table-striped table-condensed vertical-middle">
    <thead>
    <tr>
        <th>ID</th>
        <th>Ссылка</th>
        <th>Название</th>
        <th>Источник</th>
        <th>Даты</th>
        <th>Кол-во точек</th>
        <th>Операции</th>
    </thead>
    <tbody>
    {% for track in tracks_list %}
        <tr>
            <td><a title="Открыть трэк" href="{% url 'track' track.id %}">{{ track.id }}</a></td>
            <td><a title="Открыть трэк" href="{% url 'track' track.id %}">http://{{ request.get_host }}{% url 'track' track.id %}{% if not track.is_opened %}?password={{ track.view_password }}{% endif %}</a></td>
            <td>{{ track.title }}</td>
            <td>{% if track.source %}{% if track.device_id %}<a href="{% url 'edit_device' track.device_id %}">{{ track.source }}</a>{% else %}{{ track.source }}{% endif %}{% else %}Не указан{% endif %}</td>
            <td>{{ track.start_date|date:'Y-m-d H:i:s' }}<br>{{ track.end_date|date:'Y-m-d H:i:s' }}</td>
            <td>{{ track.get_positions_count }}</td>
            <td><a href="{% url 'edit_track' track.id %}" class="btn btn-sm" title="Редактировать трэк">Редактировать</a>
                <a href="{% url 'delete_track' track.id %}" class="btn btn-danger btn-sm" title="Удалить трэк">Удалить</a></td>
        </tr>
    {% endfor %}
    </tbody>
    </table>

    {% if is_paginated %}
    <div class="pagination">
        <a {% if not page_obj.has_previous %}class="disabled"{% endif %} href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}javascript:void(0);{% endif %}">&larr; Назад</a>
        <a {% if not page_obj.has_next %}class="disabled"{% endif %} href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}javascript:void(0);{% endif %}">Вперед &rarr;</a>
        <span class="page-current pull-right">Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}</span>
    </div>

    {% endif %}
{% else %}
    <h1>Создайте трэк</h1>
{% endif %}
{% endblock %}